

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="X1ly?S">
  <meta name="keywords" content="网络安全 渗透测试 web安全">
  
    <meta name="description" content="前言信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！ 收集流程概述123456789101112131415161718192021222324252627282930313233[0]自动化信息收集阶段	1.--工具自动化信息收集[1]资产发现阶段	1.--组织信息收集	2.--主域名收集	3.--子域名收集[2]资产扩展阶段	1.--端口收集	2.-">
<meta property="og:type" content="article">
<meta property="og:title" content="万字长文窥探信息收集真正的艺术">
<meta property="og:url" content="https://x1lys.github.io/2024/12/12/%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87%E7%AA%A5%E6%8E%A2%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E7%9C%9F%E6%AD%A3%E7%9A%84%E8%89%BA%E6%9C%AF/index.html">
<meta property="og:site_name" content="X1ly?S Blog">
<meta property="og:description" content="前言信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！ 收集流程概述123456789101112131415161718192021222324252627282930313233[0]自动化信息收集阶段	1.--工具自动化信息收集[1]资产发现阶段	1.--组织信息收集	2.--主域名收集	3.--子域名收集[2]资产扩展阶段	1.--端口收集	2.-">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/jf3Ho6MsB9nCxGl.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/zBIPwLUmFNEG1ud.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/aBCb25xILW4Ar1O.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/OMjivQZ5E2JayTe.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/XIier4EA5TFgMWU.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/V3sMZ5i4v9wYmAl.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/y6dVvxaT5S1hjk7.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/LfPDWyK7moUIEOi.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/3wG7JVtaElDenpj.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/1PB7jb4aTgOJfvx.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/fGdMIvOrJxtDqhC.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/heTBQqMKFwStkPW.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/NgcP9YkHiJrTOfw.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/VN4denwrYoS7CsI.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/qxwZMye3WHEFQ6U.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/3Bvt1ZwXjx7LOyT.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/MTisxb725KrOXAH.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/xgZyE6Y8GvCa5zi.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/nPjYz6sE5waKJQB.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/Wp679cMLHQReomw.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/wfQTW8dYvyJUjpG.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/mYoOx5bJt2PkW18.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/U4BC82dvOFYVlxE.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/LHvgap6FhoYK5Vw.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/2wNFzqo8EU3ivtI.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/Tf3GSIwU5eDXY6h.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/5cTR7GtDSqiyvIU.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/G6EfviBeJZ4U5n8.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/rwsv5g6njlQzYmA.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/TfapJWDS69Hxmqr.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/2gqdPDjJLNFsBR8.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/zo3AdD5gBw7s91R.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/wEfxdVQ57F9srOo.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/Qv3jtBZproIcHfe.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/cwRkmS3qoeiA7hY.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/BQa92lfgU5JDFPq.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/QoI43vZhe6EMDji.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/mVYir9jG6PubgXJ.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/exLCi9G6V3blUoH.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/SXrMLQCRux3OKka.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/pt9vUuXxaEbNyCo.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/kfASbiWuvJPxrEF.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/F2ROCZJQqbtgVwI.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/12/QJezyWLbY6whMO4.png">
<meta property="og:image" content="https://s2.loli.net/2024/12/07/o9HFcvJO8BbWf36.png">
<meta property="article:published_time" content="2024-12-12T10:15:44.000Z">
<meta property="article:modified_time" content="2024-12-12T10:16:07.907Z">
<meta property="article:author" content="X1ly?S">
<meta property="article:tag" content="网络安全 渗透测试 web安全">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2024/12/12/jf3Ho6MsB9nCxGl.png">
  
  
  
  <title>万字长文窥探信息收集真正的艺术 - X1ly?S Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"x1lys.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="万字长文窥探信息收集真正的艺术"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-12-12 18:15" pubdate>
          2024年12月12日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          10k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          87 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">万字长文窥探信息收集真正的艺术</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>信息搜集真的就只是找找子域名，扫扫目录和端口这么简单吗？万字长文带你窥探信息收集真正的艺术！</p>
<h2 id="收集流程概述"><a href="#收集流程概述" class="headerlink" title="收集流程概述"></a>收集流程概述</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs http">[0]自动化信息收集阶段<br>	1.--工具自动化信息收集<br>[1]资产发现阶段<br>	1.--组织信息收集<br>	2.--主域名收集<br>	3.--子域名收集<br>[2]资产扩展阶段<br>	1.--端口收集<br>	2.--C段收集<br>[3]资产梳理阶段<br>	1.--测活+指纹识别<br>[4]自动化扫描阶段<br>	1.--漏洞扫描器测试<br>[5]重点目标针对收集阶段<br>	1.--架构信息收集<br>	2.--源码信息收集<br>	3.--网站基本信息<br>		(1)----语言<br>		(2)----数据库<br>		(3)----web容器<br>		(4)----操作系统<br>	4.--网站深度信息收集<br>		(1)----前端源码<br>		(2)----目录<br>		(3)----端口<br>		(4)----js接口<br>		(5)----快照<br>		(6)----插件<br>		(7)----旁站<br>	5.--网盘信息<br>	6.--社工信息<br>	7.--小程序信息<br>	8.--APP信息<br></code></pre></td></tr></table></figure>

<blockquote>
<p>[0]自动化信息收集阶段：使用工具自动进行信息收集，与手工结合同时进行最佳</p>
</blockquote>
<h2 id="自动化信息收集"><a href="#自动化信息收集" class="headerlink" title="自动化信息收集"></a>自动化信息收集</h2><p>在手工信息收集之前，建议可以使用一下知名的自动化信息收集工具，帮助我们快速的进行大致的信息收集，也能与手工信息收集结果相互补充</p>
<p>没什么好说的，推荐几款工具，选择一两个觉得趁手的会用就行<br>我比较喜欢用ARL，尤其是它的文件泄露功能往往能帮我快速撕开口子，由于灯塔之前跑路了，所以要用第三方备用库</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Aabyss-Team/ARL">ARL</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/jf3Ho6MsB9nCxGl.png" srcset="/img/loading.gif" lazyload alt="image-20241212141223251"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/0x727/ShuiZe_0x727">shuize</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/knownsec/Kunyu">kunyu</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/hanc00l/nemo_go">nemo_go</a></li>
<li><a target="_blank" rel="noopener" href="https://www.scope-sentry.top/guide/y0qsb5ks/#%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2">ScopeSentry</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/zBIPwLUmFNEG1ud.png" srcset="/img/loading.gif" lazyload alt="image-20241212144726000"></p>
<blockquote>
<p>[1]资产发现阶段：收集出目标主体大部分的资产</p>
</blockquote>
<h2 id="组织结构收集"><a href="#组织结构收集" class="headerlink" title="组织结构收集"></a>组织结构收集</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>组织结构收集就是摸清目标有哪些子公司，分别处于整体什么位置，股权分别占多少比重，与主公司的结构关系等等。由于小型目标结构组织简单，是单独存在的，没有收集阻止结构的必要。所以，这个组织结构的收集是针对于比较庞大的目标的，比如大型集团、企业，大型政党单位，大型高校。</p>
<h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>那么为什么要收集目标的组织结构呢？以hw为例，假设目标是一个大型集团，收集目标的组织结构有以下作用：</p>
<ul>
<li><strong>更全面的收集到目标的所有子公司，从而得到更全的主域名，这意味着有更广的攻击面</strong></li>
<li><strong>摸清了组织结构，可以采用自下而上的打法：A公司防守很严，暴露面少很难突破，那么如果收集了组织结构就可以去找A公司的子公司作为突破口，因为子公司一般没有其主公司安全性高，而且子公司与主公司有些资产（比如办公环境，内部业务环境等等）很有可能处于同一个内网，于是只要拿下了子公司的权限，就有可能通过内网横向移动拿下主公司的权限，从而轻松拿下整个目标</strong></li>
<li><strong>摸清了组织结构，还可以采用自上而下的打法：如果已经拿下了A公司的权限，也收集了组织结构信息，那么还可以进一步攻击A公司的子公司。因为A公司中很有可能就保存了子公司的一些重要敏感数据，密码凭据等等，而且内网也很可能是连通的，也可以尝试内网横向移动，从而扩大渗透成果，爽拿数据分和权限分</strong></li>
</ul>
<h3 id="收集方法"><a href="#收集方法" class="headerlink" title="收集方法"></a>收集方法</h3><h4 id="股权收集法"><a href="#股权收集法" class="headerlink" title="股权收集法"></a>股权收集法</h4><p>以华为为例，使用<strong>爱企查</strong>看股权穿透图，收集子公司信息，(更具体的信息需要开会员)</p>
<p><img src="https://s2.loli.net/2024/12/12/aBCb25xILW4Ar1O.png" srcset="/img/loading.gif" lazyload alt="image-20241029164603070"></p>
<p><img src="https://s2.loli.net/2024/12/12/OMjivQZ5E2JayTe.png" srcset="/img/loading.gif" lazyload alt="image-20241029164721047"></p>
<p>股权占比小于50%的就不用看了，因为关联性已经不太强了</p>
<p><img src="https://s2.loli.net/2024/12/12/XIier4EA5TFgMWU.png" srcset="/img/loading.gif" lazyload alt="image-20241029164918989"></p>
<p>这样我们就能摸清目标在整个主体中处于什么位置，以及与其他公司的关系，获得了更多的子公司名。接下来，只需手动筛选出所有的股权占比大于50%的子公司名字，全部记录下来存为<strong>company.txt</strong>，还有搞清楚目标在整个主体中处于什么位置，组织结构的收集就基本完成了</p>
<h4 id="关键人物收集法"><a href="#关键人物收集法" class="headerlink" title="关键人物收集法"></a>关键人物收集法</h4><p>还可以从关键人物出发，去寻找更多子公司信息</p>
<p>比如从华为的法人入手，查看他代表的公司：</p>
<p><img src="https://s2.loli.net/2024/12/12/V3sMZ5i4v9wYmAl.png" srcset="/img/loading.gif" lazyload alt="image-20241029165709985"></p>
<p><img src="https://s2.loli.net/2024/12/12/y6dVvxaT5S1hjk7.png" srcset="/img/loading.gif" lazyload alt="image-20241029165812138"></p>
<p>以及从华为的高管入手：</p>
<p><img src="https://s2.loli.net/2024/12/12/LfPDWyK7moUIEOi.png" srcset="/img/loading.gif" lazyload alt="image-20241029165928192"></p>
<p>得到的结果能与上面提到的股权收集法互相补充</p>
<p>到此我们就得到了目标集团的所有股权占比较大的子公司名，保存为<strong>company.txt</strong>，后面有用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"># company.txt <br># 为了便于演示，我就只列举几个<br><br>华为技术有限公司<br>华为投资控股有限公司<br>深圳市华为电气股份有限公司<br>深圳市华为技术软件有限公司<br>......<br></code></pre></td></tr></table></figure>

<h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><ul>
<li>爱企查：<a target="_blank" rel="noopener" href="https://aiqicha.baidu.com/">https://aiqicha.baidu.com/</a></li>
</ul>
<h2 id="主域名收集"><a href="#主域名收集" class="headerlink" title="主域名收集"></a>主域名收集</h2><p>收集主域名就是利用前面组织结构收集到的子公司名<strong>company.txt</strong> ，进一步分别收集他们公司的主域名，这是环环相扣的，只有组织结构收集收集得越全，收集到的主域名才会越多，攻击面才越广，才越有可能拿下目标</p>
<h3 id="ICP备案"><a href="#ICP备案" class="headerlink" title="ICP备案"></a>ICP备案</h3><h4 id="官网查询接口"><a href="#官网查询接口" class="headerlink" title="官网查询接口"></a>官网查询接口</h4><p>在中国想正规搭建网站都是需要ICP备案的，于是我们可以利用官方ICP备案查询公司名，得到其主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/3wG7JVtaElDenpj.png" srcset="/img/loading.gif" lazyload alt="image-20241029171741485"></p>
<p>非常的多，点击详情就能看到该公司的主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/1PB7jb4aTgOJfvx.png" srcset="/img/loading.gif" lazyload alt="image-20241029171830746"></p>
<p>该方法适合于子公司比较少的情况，因为该官网查询接口，有图形汉字验证码，不太好批量提取出子公司的主域名，只能手动复制下来，适合于小型目标</p>
<h4 id="第三方程序查询接口"><a href="#第三方程序查询接口" class="headerlink" title="第三方程序查询接口"></a>第三方程序查询接口</h4><p><img src="https://s2.loli.net/2024/12/12/fGdMIvOrJxtDqhC.png" srcset="/img/loading.gif" lazyload alt="image-20241029172828417"></p>
<p>这个第三方程序查询接口好处是无验证码，可以批量提取出所有子公司的主域名，适用于大型目标，但是缺点是没有官网查询接口更新的快</p>
<p>使用icpsearch工具就能批量爬下来了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">icpsearch -f compoany.txt<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/heTBQqMKFwStkPW.png" srcset="/img/loading.gif" lazyload alt="image-20241029173615368"></p>
<p>得到的结果再使用Sublime Text正则匹配一下域名就行了，Ctrl+F 输入正则表达式，勾选Find All选中全部，再右键复制全部</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">([a-zA-Z0-9-]+\.)+[a-zA-Z]&#123;2,&#125;<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/NgcP9YkHiJrTOfw.png" srcset="/img/loading.gif" lazyload alt="image-20241029174420902"></p>
<p><img src="https://s2.loli.net/2024/12/12/VN4denwrYoS7CsI.png" srcset="/img/loading.gif" lazyload alt="image-20241030000850266"></p>
<p>这样就提取出了域名</p>
<p><img src="https://s2.loli.net/2024/12/12/qxwZMye3WHEFQ6U.png" srcset="/img/loading.gif" lazyload alt="image-20241030001004828"></p>
<h3 id="小蓝本"><a href="#小蓝本" class="headerlink" title="小蓝本"></a>小蓝本</h3><p>使用小蓝本也可以快速收集主域名，只不过也不能一次性的查所有子公司的主域名，不过可以写脚本爬取</p>
<p>来到知识产权，一键获取ICP备案</p>
<p><img src="https://s2.loli.net/2024/12/12/3Bvt1ZwXjx7LOyT.png" srcset="/img/loading.gif" lazyload alt="image-20241030001301711"></p>
<p><img src="https://s2.loli.net/2024/12/12/MTisxb725KrOXAH.png" srcset="/img/loading.gif" lazyload alt="image-20241030001320792"></p>
<p>手动复制一下，保存本地，再使用Sublime Text正则提取出主域名</p>
<p><img src="https://s2.loli.net/2024/12/12/xgZyE6Y8GvCa5zi.png" srcset="/img/loading.gif" lazyload alt="image-20241030001446026"></p>
<p><img src="https://s2.loli.net/2024/12/12/nPjYz6sE5waKJQB.png" srcset="/img/loading.gif" lazyload alt="image-20241030001514457"></p>
<p>到此我们就通过<strong>company.txt</strong>收集到了很多的子公司的主域名，保存为<strong>domain.txt</strong>，后面有用</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http"># domain.txt<br>androidga.com<br>www.hwtrip.com<br>hwtrip.com<br>www.huaweils.com<br>huaweils.com<br>www.smartcom.cc<br>smartcom<br>......<br></code></pre></td></tr></table></figure>

<h3 id="工具-1"><a href="#工具-1" class="headerlink" title="工具"></a>工具</h3><ul>
<li>ICP备案官网：<a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">https://beian.miit.gov.cn/</a></li>
<li>ICP第三方查询：<a target="_blank" rel="noopener" href="https://www.beianx.cn/">https://www.beianx.cn/</a></li>
<li>ICP批量爬取工具：<a target="_blank" rel="noopener" href="https://github.com/A10ha/ICPSearch">https://github.com/A10ha/ICPSearch</a></li>
<li>Sublmie Text：<a target="_blank" rel="noopener" href="https://www.sublimetext.com/">https://www.sublimetext.com/</a></li>
<li>小蓝本：<a target="_blank" rel="noopener" href="https://sou.xiaolanben.com/">https://sou.xiaolanben.com/</a></li>
</ul>
<h2 id="子域名收集"><a href="#子域名收集" class="headerlink" title="子域名收集"></a>子域名收集</h2><h3 id="网络测绘引擎"><a href="#网络测绘引擎" class="headerlink" title="网络测绘引擎"></a>网络测绘引擎</h3><ul>
<li>fofa</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain =&quot;主域名&quot; || cert=&quot;公用名&quot; || cert=&quot;组织名1&quot; ||  || cert=&quot;组织名2&quot; || cert=&quot;组织名3&quot; ......<br></code></pre></td></tr></table></figure>

<p>我习惯使用fofa查询，其他网络测绘搜索引擎也可以</p>
<p>domain是通过域名查，能查到web资产与非web资产，cert是通过证书查，只能查web资产，二者使用” || “结合拼接，会得到更多的子域名资产</p>
<h4 id="综合语法"><a href="#综合语法" class="headerlink" title="综合语法"></a>综合语法</h4><p>比如还是以华为为例：huaweiyun.com</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain=&quot;huaweiyun.com&quot;<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/Wp679cMLHQReomw.png" srcset="/img/loading.gif" lazyload alt="image-20241030085729157"></p>
<p>仅仅使用<strong>domain &#x3D;”主域名”</strong> 能查到4条子域名，如果加上cert证书查询语法呢？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain=&quot;huaweiyun.com&quot; || cert=&quot;huaweiyun.com&quot;<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/wfQTW8dYvyJUjpG.png" srcset="/img/loading.gif" lazyload alt="image-20241030085817666"></p>
<p>资产直接多了一倍！那么可想而知，如果使用网络测绘引擎收集资产不使用cert查询语法的话，会错过很多的隐蔽资产</p>
<p>那么到这里就结束了吗？并没有</p>
<p>刚才我们只是使用了**domain &#x3D;”主域名” || cert&#x3D;”公用名”**还没有考虑到其他公用名，和更多的组织名！</p>
<p><strong>注意！公用名大多数时候就是网站的主域名或子域名，而同一个主域名的资产可能有多个组织名，于是我们都要尽可能多的找出来</strong></p>
<p>怎么找公用名和组织名呢？我的方法是手动翻找https站点的证书</p>
<p>比如，点击查看几个https站点的证书详情</p>
<p><img src="https://s2.loli.net/2024/12/12/mYoOx5bJt2PkW18.png" srcset="/img/loading.gif" lazyload alt="image-20241030090526688"></p>
<p><img src="https://s2.loli.net/2024/12/12/U4BC82dvOFYVlxE.png" srcset="/img/loading.gif" lazyload alt="image-20241030090619680"></p>
<p><img src="https://s2.loli.net/2024/12/12/LHvgap6FhoYK5Vw.png" srcset="/img/loading.gif" lazyload alt="image-20241030090648454"></p>
<p>这里就找到了新的公用名和组织名！</p>
<p><img src="https://s2.loli.net/2024/12/12/2wNFzqo8EU3ivtI.png" srcset="/img/loading.gif" lazyload alt="image-20241030090750668"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">huaweicloud.com<br>Huawei Software Technologies Co., Ltd.<br></code></pre></td></tr></table></figure>

<p>继续拼接到fofa的cert语法中去，看看会发生什么？</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain=&quot;huaweiyun.com&quot; || cert=&quot;huaweicloud.com&quot; || cert=&quot;Huawei Software Technologies Co., Ltd.&quot;<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/Tf3GSIwU5eDXY6h.png" srcset="/img/loading.gif" lazyload alt="image-20241030091207877"></p>
<p>好家伙直接干到了89830条！不得不说是真的很全，但是这么多资产也不方便测试，这里只是说可以用这种cert查询方式收集到更多的资产，扩大攻击面，实际肯定要根据情况而定，要学会灵活变通。像华为这种超级大型企业，资产本身就不少，所以不太适合使用证书查询，因为太多了，更多的适用于资产在几千条以内的中小型企业、政党单位、高校等等</p>
<h4 id="批量"><a href="#批量" class="headerlink" title="批量"></a>批量</h4><p>相信师傅注意到了，我们上面不是收集了大量的<strong>domain.txt</strong>吗，但是刚刚演示时只选取了其中一条来查询子域名，如何批量查询<strong>domain.txt</strong>的全部子域名呢？我是这么做的：</p>
<p>写了一个脚本，读取<strong>domain.txt</strong>，直接批量拼接成<strong>domain &#x3D;”主域名1” || cert&#x3D;”公用名1” || domain &#x3D;”主域名2” || cert&#x3D;”公用名2” || domain &#x3D;”主域名3” || cert&#x3D;”公用名3” ||……</strong>这种格式，再丢到fofa去查询</p>
<p>为什么这样拼接呢，就是因为公用名大多数时候就是其主域名或子域名，使用”||”连接就能查到更多的资产了</p>
<h5 id="脚本-join-py"><a href="#脚本-join-py" class="headerlink" title="脚本-join.py"></a>脚本-join.py</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python join.py<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 读取 domain.txt 文件并拼接数据</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_and_concatenate</span>(<span class="hljs-params">file_path</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            <span class="hljs-comment"># 读取文件中的每一行，去掉空格和换行符</span><br>            lines = [line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file <span class="hljs-keyword">if</span> line.strip()]<br><br>        <span class="hljs-comment"># 使用 &#x27; || &#x27; 连接每行数据</span><br>        result = <span class="hljs-string">&#x27; || &#x27;</span>.join([<span class="hljs-string">f&#x27;domain=&quot;<span class="hljs-subst">&#123;line&#125;</span>&quot; || cert=&quot;<span class="hljs-subst">&#123;line&#125;</span>&quot;&#x27;</span> <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines])<br><br>        <span class="hljs-built_in">print</span>(result)<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;文件 <span class="hljs-subst">&#123;file_path&#125;</span> 未找到。&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;发生错误: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 调用函数并传入文件路径</span><br>read_and_concatenate(<span class="hljs-string">&#x27;domain.txt&#x27;</span>)<br></code></pre></td></tr></table></figure>

<ul>
<li>域名太多只演示部分</li>
</ul>
<p><img src="https://s2.loli.net/2024/12/12/5cTR7GtDSqiyvIU.png" srcset="/img/loading.gif" lazyload alt="image-20241030095140091"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain=&quot;www.openinula.net&quot; || cert=&quot;www.openinula.net&quot; || domain=&quot;www.huaweiirad.com&quot; || cert=&quot;www.huaweiirad.com&quot; || domain=&quot;www.bescloud.com.cn&quot; || cert=&quot;www.bescloud.com.cn&quot; || domain=&quot;www.bescloud.cn&quot; || cert=&quot;www.bescloud.cn&quot; || domain=&quot;www.gneec3.cn&quot; || cert=&quot;www.gneec3.cn&quot; || domain=&quot;www.gneec5.cn&quot; || cert=&quot;www.gneec5.cn&quot; ||domain=&quot;www.gneec4.cn&quot; || cert=&quot;www.gneec4.cn&quot; ||domain=&quot;www.appcubecloud.com.cn&quot;||cert=&quot;www.appcubecloud.com.cn&quot; || domain=&quot;www.besclouds.com.cn&quot; || cert=&quot;www.besclouds.com.cn&quot;||domain=&quot;www.besclouds.cn&quot;||cert=&quot;www.besclouds.cn&quot; || domain=&quot;www.gtscsm.com&quot; || cert=&quot;www.gtscsm.com&quot; || domain=&quot;www.appcubecloud.cn&quot; || cert=&quot;www.appcubecloud.cn&quot;|| domain=&quot;www.vrbtcloud.cn&quot; || cert=&quot;www.vrbtcloud.cn&quot;<br></code></pre></td></tr></table></figure>

<p>但是师傅也发现了这样还缺少通过组织名查询，于是我们还要手动地去翻找https站点的证书，<strong>或者再结合接下来”英文证书查询”方法</strong>，手动复制出公用名+组织名，也拼接到cert语法中。因为大量资产的公用名+组织名都是一致的，所以手动就行了</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">domain=&quot;www.openinula.net&quot; || cert=&quot;www.openinula.net&quot; || domain=&quot;www.huaweiirad.com&quot; || cert=&quot;www.huaweiirad.com&quot; || domain=&quot;www.bescloud.com.cn&quot; || cert=&quot;www.bescloud.com.cn&quot; || domain=&quot;www.bescloud.cn&quot; || cert=&quot;www.bescloud.cn&quot; || domain=&quot;www.gneec3.cn&quot; || cert=&quot;www.gneec3.cn&quot; || domain=&quot;www.gneec5.cn&quot; || cert=&quot;www.gneec5.cn&quot; ||domain=&quot;www.gneec4.cn&quot; || cert=&quot;www.gneec4.cn&quot; ||domain=&quot;www.appcubecloud.com.cn&quot;||cert=&quot;www.appcubecloud.com.cn&quot; || domain=&quot;www.besclouds.com.cn&quot; || cert=&quot;www.besclouds.com.cn&quot;||domain=&quot;www.besclouds.cn&quot;||cert=&quot;www.besclouds.cn&quot; || domain=&quot;www.gtscsm.com&quot; || cert=&quot;www.gtscsm.com&quot; || domain=&quot;www.appcubecloud.cn&quot; || cert=&quot;www.appcubecloud.cn&quot;|| domain=&quot;www.vrbtcloud.cn&quot; || cert=&quot;www.vrbtcloud.cn&quot; || cert=&quot;huaweicloud.com&quot; || cert=&quot;Huawei Software Technologies Co., Ltd.&quot; <br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/G6EfviBeJZ4U5n8.png" srcset="/img/loading.gif" lazyload alt="image-20241030104500909"></p>
<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><h5 id="all模式开启"><a href="#all模式开启" class="headerlink" title="all模式开启"></a>all模式开启</h5><p>使用网络测绘引擎，还需要注意的是，不要忘记开启all模式，因为查询结果默认情况下只有一年内的结果，开启all模式就能查到更多的资产，更有概率发现隐蔽资产！</p>
<p>但是需要开会员，呜呜贵贵~</p>
<p><img src="https://s2.loli.net/2024/12/12/rwsv5g6njlQzYmA.png" srcset="/img/loading.gif" lazyload alt="image-20241030104630781"></p>
<h4 id="格式处理"><a href="#格式处理" class="headerlink" title="格式处理"></a>格式处理</h4><p>导出fofa结果时有一个问题就是资产格式有点混乱、不够统一，比如这样</p>
<p><img src="https://s2.loli.net/2024/12/12/TfapJWDS69Hxmqr.png" srcset="/img/loading.gif" lazyload alt="image-20241030110434561"></p>
<p>URL列中同时有https+域名的，又有https+ip的，还有不带http协议头的纯域名与纯ip的格式，这样不便于后面分别的信息收集，因为纯域名会用来做c段整理，纯ip用来端口扫描，带协议头的URL用来测活或者爬取js，漏扫等等……于是需要处理格式，把他们分离出来</p>
<p>还是使用脚本处理</p>
<h5 id="脚本-format-py"><a href="#脚本-format-py" class="headerlink" title="脚本-format.py"></a>脚本-format.py</h5><p>输入input.txt-格式混乱的url列 ，输出<strong>subdomain-1.txt</strong>-子域名，<strong>url-1.txt</strong>-url。ip就不用分离了，fofa本身能导出格式整齐的ip列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python format.py<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> chardet<br><br><span class="hljs-comment"># 自动检测文件编码</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">detect_encoding</span>(<span class="hljs-params">filename</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>        result = chardet.detect(file.read())<br>    <span class="hljs-keyword">return</span> result[<span class="hljs-string">&#x27;encoding&#x27;</span>]<br><br><span class="hljs-comment"># 读取文件并处理内容</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_file</span>(<span class="hljs-params">input_file, subdomain_file, url_file</span>):<br>    encoding = detect_encoding(input_file)<br>    <br>    <span class="hljs-comment"># 打开input.txt文件并读取每一行</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=encoding) <span class="hljs-keyword">as</span> file:<br>        lines = file.readlines()<br><br>    <span class="hljs-comment"># 准备两个列表来存储不同的输出内容</span><br>    subdomains = []<br>    urls = []<br><br>    <span class="hljs-comment"># 定义一个正则表达式来匹配特定的IP地址URL</span><br>    specific_ip_url_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&#x27;http[s]?://127\.0\.0\.1(:\d+)?/?&#x27;</span>)<br><br>    <span class="hljs-comment"># 处理每一行数据</span><br>    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>        <span class="hljs-comment"># 去除两端的空格和换行符</span><br>        line = line.strip()<br><br>        <span class="hljs-comment"># 检查URL是否是特定的IP地址URL</span><br>        <span class="hljs-keyword">if</span> specific_ip_url_pattern.<span class="hljs-keyword">match</span>(line):<br>            <span class="hljs-comment"># 如果是，则直接写入url.txt</span><br>            urls.append(line)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-comment"># 检查URL是否基于IP地址，如果是则跳过</span><br>            <span class="hljs-keyword">if</span> re.<span class="hljs-keyword">match</span>(<span class="hljs-string">r&#x27;http[s]?://\d&#123;1,3&#125;(\.\d&#123;1,3&#125;)&#123;3&#125;(:\d+)?/?&#x27;</span>, line):<br>                <span class="hljs-keyword">continue</span>  <span class="hljs-comment"># 如果当前行是基于IP的URL，跳过不处理</span><br><br>            <span class="hljs-comment"># 检查并处理每种情况</span><br>            <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;http://&#x27;</span>):<br>                subdomains.append(line[<span class="hljs-number">7</span>:])  <span class="hljs-comment"># 从&#x27;http://&#x27;后面开始截取</span><br>                urls.append(line)  <span class="hljs-comment"># 保持原样</span><br>            <span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;https://&#x27;</span>):<br>                subdomains.append(line[<span class="hljs-number">8</span>:])  <span class="hljs-comment"># 从&#x27;https://&#x27;后面开始截取</span><br>                urls.append(line)  <span class="hljs-comment"># 保持原样</span><br>            <span class="hljs-keyword">else</span>:<br>                subdomains.append(line)  <span class="hljs-comment"># 没有协议头，直接使用</span><br>                urls.append(<span class="hljs-string">&#x27;http://&#x27;</span> + line)  <span class="hljs-comment"># 添加&#x27;http://&#x27;</span><br>                urls.append(<span class="hljs-string">&#x27;https://&#x27;</span> + line) <span class="hljs-comment"># 添加&quot;https://&quot; </span><br><br>    <span class="hljs-comment"># 将处理后的数据写入相应的文件</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(subdomain_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=encoding) <span class="hljs-keyword">as</span> file:<br>        <span class="hljs-keyword">for</span> subdomain <span class="hljs-keyword">in</span> subdomains:<br>            file.write(subdomain + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(url_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=encoding) <span class="hljs-keyword">as</span> file:<br>        <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:<br>            file.write(url + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br><span class="hljs-comment"># 调用处理函数</span><br>process_file(<span class="hljs-string">&#x27;input.txt&#x27;</span>, <span class="hljs-string">&#x27;subdomain.txt&#x27;</span>, <span class="hljs-string">&#x27;url.txt&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/2gqdPDjJLNFsBR8.png" srcset="/img/loading.gif" lazyload alt="image-20241030112717560"></p>
<p><img src="https://s2.loli.net/2024/12/12/zo3AdD5gBw7s91R.png" srcset="/img/loading.gif" lazyload alt="image-20241030112733870"></p>
<p><strong>还有一点需要注意，就是有些站点只能使用https访问，有些又只能使用http访问，有些都可以，而且使用http访问原本是https的站点还有可能绕过waf，于是整理格式生成url.txt时，最好把每个域名都添加上http+https，这样资产更全，但是也可根据实际情况而定，只要http或者只要https的，只需在脚本中注释即可</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 检查并处理每种情况</span><br><span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;http://&#x27;</span>):<br>    subdomains.append(line[<span class="hljs-number">7</span>:])  <span class="hljs-comment"># 从&#x27;http://&#x27;后面开始截取</span><br>    urls.append(line)  <span class="hljs-comment"># 保持原样</span><br><span class="hljs-keyword">elif</span> line.startswith(<span class="hljs-string">&#x27;https://&#x27;</span>):<br>    subdomains.append(line[<span class="hljs-number">8</span>:])  <span class="hljs-comment"># 从&#x27;https://&#x27;后面开始截取</span><br>    urls.append(line)  <span class="hljs-comment"># 保持原样</span><br><span class="hljs-keyword">else</span>:<br>    subdomains.append(line)  <span class="hljs-comment"># 没有协议头，直接使用</span><br>    urls.append(<span class="hljs-string">&#x27;http://&#x27;</span> + line)  <span class="hljs-comment"># 添加&#x27;http://&#x27;</span><br>    <span class="hljs-comment">#urls.append(&#x27;https://&#x27; + line) # 添加&quot;https://&quot; </span><br></code></pre></td></tr></table></figure>

<p><strong>不过还好fofa中导出的ip格式是规范的，就不需要处理了，直接复制下来，保存为 ip-1.txt</strong></p>
<p>到此我们就通过<strong>domain.txt</strong>得到了 <strong>subdomain-1.txt</strong> <strong>url-1.txt ip-1.txt</strong>了保存备用，后面会合并去重</p>
<h3 id="英文证书查询"><a href="#英文证书查询" class="headerlink" title="英文证书查询"></a>英文证书查询</h3><p>除了fofa中的证书查询，还可以使用crt.sh查询网站查询证书为英文名的资产，这样也能找到很多隐蔽资产！二者可以相互补充，并且这种方式可以得到大量公用名、组织名，也可以手动拼接上述语法中去！</p>
<h4 id="查询方式"><a href="#查询方式" class="headerlink" title="查询方式"></a>查询方式</h4><h5 id="q模式"><a href="#q模式" class="headerlink" title="q模式"></a>q模式</h5><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">q</span>=huawei.com<br></code></pre></td></tr></table></figure>

<p>比较精准的模式</p>
<p><img src="https://s2.loli.net/2024/12/12/wEfxdVQ57F9srOo.png" srcset="/img/loading.gif" lazyload alt="image-20241030101407640"></p>
<h5 id="o模式"><a href="#o模式" class="headerlink" title="o模式"></a>o模式</h5><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">o</span>=huawei<br></code></pre></td></tr></table></figure>

<p>模糊查询模式</p>
<p><img src="https://s2.loli.net/2024/12/12/Qv3jtBZproIcHfe.png" srcset="/img/loading.gif" lazyload alt="image-20241030103550030"></p>
<p>o模式有些情况下查不出来</p>
<h4 id="批量-1"><a href="#批量-1" class="headerlink" title="批量"></a>批量</h4><p>还是写脚本，批量正则提取一下common name公用名，因为公用名大多数时候就是域名或子域名，于是这种方式也能直接得到许多隐蔽资产，许多挖SRC的大佬就是直接使用crt.sh开怼的！</p>
<h5 id="脚本-crt-sh-py"><a href="#脚本-crt-sh-py" class="headerlink" title="脚本-crt.sh.py"></a>脚本-crt.sh.py</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python crt.sh.py<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_unique_common_names</span>(<span class="hljs-params">url</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 自定义 User-Agent 头</span><br>        headers = &#123;<br>            <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36&quot;</span><br>        &#125;<br>        <br>        <span class="hljs-comment"># 获取页面内容</span><br>        response = requests.get(url, headers=headers)<br>        response.raise_for_status()  <span class="hljs-comment"># 检查是否请求成功</span><br>        html_content = response.text<br>        <br>        <span class="hljs-comment"># 提取 &lt;TD&gt; 标签中以 .cn, .com, .org, .net 结尾的内容</span><br>        common_names = re.findall(<span class="hljs-string">r&#x27;&lt;TD.*?&gt;([^&lt;]*\.(?:cn|com|org|net))&lt;/TD&gt;&#x27;</span>, html_content, re.S)<br>        <br>        <span class="hljs-comment"># 去重处理</span><br>        unique_common_names = <span class="hljs-built_in">set</span>(common_names)<br>        <br>        <span class="hljs-comment"># 输出提取的公用名</span><br>        <span class="hljs-keyword">if</span> unique_common_names:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Extracted Unique Common Names:&quot;</span>)<br>            <span class="hljs-keyword">for</span> name <span class="hljs-keyword">in</span> unique_common_names:<br>                <span class="hljs-built_in">print</span>(name.strip())  <span class="hljs-comment"># 去掉前后的空格</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No Common Names found.&quot;</span>)<br>    <span class="hljs-keyword">except</span> requests.RequestException <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error fetching URL: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 调用函数并传入 URL</span><br>url = <span class="hljs-string">&quot;https://crt.sh/?q=baidu.com&quot;</span>  <span class="hljs-comment"># 替换为实际的查询目标和模式</span><br>extract_unique_common_names(url)<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/cwRkmS3qoeiA7hY.png" srcset="/img/loading.gif" lazyload alt="image-20241030105907553"></p>
<h4 id="格式处理-1"><a href="#格式处理-1" class="headerlink" title="格式处理"></a>格式处理</h4><p>还是如法炮制，把这些域名复制下来，使用刚才的格式处理format.txt脚本生成带有协议头的url资产和不带协议头的子域名资产</p>
<p>到此我们又得到了<strong>subdomain-2.txt url-2.txt</strong></p>
<h3 id="oneforall"><a href="#oneforall" class="headerlink" title="oneforall"></a>oneforall</h3><p>这位更是重量级，从名字都能看出来，这个工具集成了网上提到的所有收集子域名的方式，是的所有！crt.sh查找、VT查找、百度谷歌语法、各种测绘引擎，各种查询接口，子域名爆破，host碰撞，dns域传送，dns查询，子域名接管，fuzz等等一系列的方法！</p>
<p>但是如何最大化利用好oneforall呢？需要进行各种外调api配置，各种模块开启，才能发挥它的最大功效</p>
<p>也就是去config目录，把配置文件中的能配置的api（有些要收费，可以选择不配），都配置一下，各个模块启动一下</p>
<p><img src="https://s2.loli.net/2024/12/12/BQa92lfgU5JDFPq.png" srcset="/img/loading.gif" lazyload alt="image-20241103171959834"></p>
<p><img src="https://s2.loli.net/2024/12/12/QoI43vZhe6EMDji.png" srcset="/img/loading.gif" lazyload alt="image-20241103170421148"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python oneforall.py --target huaweiyun.com run<br>python oneforall.py --targets domain.txt run<br></code></pre></td></tr></table></figure>

<h4 id="格式处理-2"><a href="#格式处理-2" class="headerlink" title="格式处理"></a>格式处理</h4><p>以huaweiyun.com单个目标做演示，实际是对整个domain.txt中的主域名批量找子域名，但是如果太多也可以自由取舍。</p>
<p>oneforall的结果就比较规范了，不需要处理了</p>
<p><img src="https://s2.loli.net/2024/12/12/mVYir9jG6PubgXJ.png" srcset="/img/loading.gif" lazyload alt="image-20241103172320113"></p>
<p>到此我们就又通过<strong>domain.txt</strong>得到了 <strong>subdomain-3.txt</strong> <strong>url-2.txt ip-2.txt</strong></p>
<h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p>接下来，把<strong>subdomain-1.txt</strong> <strong>url-1.txt ip-1.txt</strong> <strong>subdomain-2.txt</strong> **url-2.txt ** <strong>subdomain-3.txt</strong> <strong>url-3.txt ip-2.txt</strong>分别合并为</p>
<p><strong>subdomain.txt</strong> <strong>url.txt ip.txt</strong> 再去重就行</p>
<p>这样在收集了子域名的同时，也收集了整理了URL和IP资产，用于接下来的信息收集</p>
<h3 id="工具-2"><a href="#工具-2" class="headerlink" title="工具"></a>工具</h3><ul>
<li>FOFA：<a target="_blank" rel="noopener" href="https://fofa.info/">https://fofa.info/</a></li>
<li>英文证书查询：<a target="_blank" rel="noopener" href="https://crt.sh/">https://crt.sh/</a></li>
<li>oneforall：<a target="_blank" rel="noopener" href="https://github.com/shmilylty/OneForAll">https://github.com/shmilylty/OneForAll</a></li>
<li>去重：<a target="_blank" rel="noopener" href="https://www.iamwawa.cn/quchong.html">https://www.iamwawa.cn/quchong.html</a></li>
</ul>
<blockquote>
<p>[2]资产扩展阶段：进一步收集更多隐蔽的资产</p>
</blockquote>
<h2 id="端口收集"><a href="#端口收集" class="headerlink" title="端口收集"></a>端口收集</h2><p>上面收集了大量的主域名，子域名，已经得到了大量初步资产，但是我们都知道一个服务器可以开65535个端口，对于有些不富裕的目标来说，他们往往会在一个服务器上开放多个端口，部署多个web资产，于是端口收集就显得特别重要，这能帮我们进一步打开攻击面，发现更多的比较隐蔽的资产。于是我们对前面收集整理到的<strong>ip.txt</strong>进行全端口扫描！这里就体现了前面为什么要整理好格式了</p>
<p>端口扫描的话，我们使用fscan来做，同时还能进行基础的漏洞扫描和弱口令爆破</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">fscan.exe -hf ip.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/exLCi9G6V3blUoH.png" srcset="/img/loading.gif" lazyload alt="image-20241204091446441"></p>
<p>扫描时间比较长，建议放在国外的VPS上后台运行完成</p>
<p>扫描完成之后，fscan的输出格式比较混乱，不便于进行数据整理，于是还可以使用下fscanoutput.py这个脚本，进行扫描结果归类整理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python fscanOutput.py result.txt<br></code></pre></td></tr></table></figure>

<h3 id="工具-3"><a href="#工具-3" class="headerlink" title="工具"></a>工具</h3><ul>
<li>fscan：<a target="_blank" rel="noopener" href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></li>
<li>fscanoutput：<a target="_blank" rel="noopener" href="https://github.com/ZororoZ/fscanOutput">https://github.com/ZororoZ/fscanOutput</a></li>
</ul>
<h2 id="C段收集"><a href="#C段收集" class="headerlink" title="C段收集"></a>C段收集</h2><p>但是，我们有时候也不要忘记收集，C段，为什么呢？因为很多大型目标购买ip资产时都是按照C段来买的，比如220.111.222.1&#x2F;24这个C段可能就是全部属于某一个大型目标的，同时，在一些情况下，有些ip资产不易被常规的收集方法找到，这会导致我们漏掉一些隐蔽的资产。比如有些ip资产既没有证书，也没有配置域名，那么这种情况，我们无脑地去扫描目标的几个C段，探测该C段下，有哪些ip存活，存活的ip又有哪些端口开放……这样就又有可能发现一些更加隐蔽的ip资产，从而发现更多潜在的攻击面！但是如果目标是小型目标，那么不推荐收集C段，因为在同一个C段中，属于该目标的ip资产压根就不多，很容易打偏！</p>
<p>那么怎么收集目标的C段呢？</p>
<p>推荐使用Eeyes根据目标的域名列表，整理目标的C段，这里又用到了前面收集整理的 subdomain.txt</p>
<p>该工具会优先排除架设有CDN的资产，然后再进行C段整理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Eeyes -l subdomain.txt<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/SXrMLQCRux3OKka.png" srcset="/img/loading.gif" lazyload alt="image-20241204093614077"></p>
<p>根据整理结果手动选择几个存活ip比较多的C段，保存为c.txt</p>
<p><img src="https://s2.loli.net/2024/12/12/pt9vUuXxaEbNyCo.png" srcset="/img/loading.gif" lazyload alt="image-20241204094129791"></p>
<p>拿到这些C段之后，下一步干什么呢，当然是端口扫描啊，也就是与上面的ip.txt，合并为ip_c.txt 还是交给fscan全端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">fscan.exe -hf ip_c.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt<br></code></pre></td></tr></table></figure>

<p>最后，再补充一点，就是有些情况下，资产严格绑定了域名，就是比如域名是test.com:8080，其ip是111.222.333.444:8080，但是访问111.222.333.444:8080是无法访问的，于是为了万无一失，还可以把subdomain.txt也加进去，进行全端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">fscan.exe -hf ip_c_subdomain.txt -t 3000 -p 1-65535 -num 100 -np -o result.txt<br></code></pre></td></tr></table></figure>

<p>等待fscan扫描完成后，就有可能发现更多的web资产，再把他们合并入url.txt中，这样操作下来，url.txt的资产就更全了！</p>
<h3 id="工具-4"><a href="#工具-4" class="headerlink" title="工具"></a>工具</h3><ul>
<li>Eeyes：<a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/Eeyes">https://github.com/EdgeSecurityTeam/Eeyes</a></li>
</ul>
<h2 id="HOST碰撞"><a href="#HOST碰撞" class="headerlink" title="HOST碰撞"></a>HOST碰撞</h2><p>当然，既然是”进一步收集更多隐蔽的资产”，那肯定少不了HOST碰撞。前面不是已经收集整理到了 subdomain.txt 以及 ip_c.txt 吗，那我们再把subdomain.txt 去批量解析一下域名，记录下无法正常解析的域名，就作为待碰撞的域名字典，ip_c.txt一般不算太多，于是可以直接全部拿去碰撞，或者手工筛选出几个也是OK的</p>
<h5 id="脚本-domain-auth-py"><a href="#脚本-domain-auth-py" class="headerlink" title="脚本-domain_auth.py"></a>脚本-domain_auth.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_domain_resolution</span>(<span class="hljs-params">domain</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-comment"># 尝试获取域名对应的IP地址</span><br>        ip = socket.gethostbyname(domain)<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">except</span> socket.gaierror:<br>        <span class="hljs-comment"># 如果发生解析错误，说明该域名无法解析</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-comment"># 读取子域名文件</span><br>    input_file = <span class="hljs-string">&#x27;subdomain.txt&#x27;</span><br>    output_file = <span class="hljs-string">&#x27;result.txt&#x27;</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>        domains = [line.strip() <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> file.readlines()]<br><br>    <span class="hljs-comment"># 检查每个域名的解析情况</span><br>    unresolved_domains = []<br>    <span class="hljs-keyword">for</span> domain <span class="hljs-keyword">in</span> domains:<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> check_domain_resolution(domain):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;无法解析的域名: <span class="hljs-subst">&#123;domain&#125;</span>&quot;</span>)<br>            unresolved_domains.append(domain)<br><br>    <span class="hljs-comment"># 将无法解析的域名写入到result.txt</span><br>    <span class="hljs-keyword">if</span> unresolved_domains:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> result_file:<br>            <span class="hljs-keyword">for</span> domain <span class="hljs-keyword">in</span> unresolved_domains:<br>                result_file.write(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;domain&#125;</span>\n&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;解析异常的域名已写入 <span class="hljs-subst">&#123;output_file&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;所有域名均能解析&quot;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure>

<p>经过HOST碰撞后，运气好的话直接就撕开口子了，可能发现一些敏感脆弱的资产</p>
<p>具体host碰撞的原理与利用这里不展开讨论，可以看笔者的这一篇文章：<a href="https://x1lys.github.io/2024/12/07/%E5%A6%82%E4%BD%95HOST%E7%A2%B0%E6%92%9E%E6%8C%96%E6%8E%98%E9%9A%90%E8%94%BD%E8%B5%84%E4%BA%A7/">如何HOST碰撞挖掘隐蔽资产</a></p>
<h3 id="工具-5"><a href="#工具-5" class="headerlink" title="工具"></a>工具</h3><ul>
<li>HostCollision：<a target="_blank" rel="noopener" href="https://github.com/pmiaowu/HostCollision">https://github.com/pmiaowu/HostCollision</a></li>
<li>Hosts_scan：<a target="_blank" rel="noopener" href="https://github.com/fofapro/Hosts_scan">https://github.com/fofapro/Hosts_scan</a></li>
</ul>
<blockquote>
<p>[3]资产梳理阶段：接下来就行测活与指纹识别，便于我们快速梳理攻击面，发现薄弱点</p>
</blockquote>
<h2 id="测活-指纹识别"><a href="#测活-指纹识别" class="headerlink" title="测活+指纹识别"></a>测活+指纹识别</h2><p>目前我们已经得到了经过了整合的url.txt，为了更全一点，我们把之前整理的ip.txt也加入进去，加入之前，先给每一个ip加上http协议头</p>
<h5 id="脚本ipadd-py"><a href="#脚本ipadd-py" class="headerlink" title="脚本ipadd.py"></a>脚本ipadd.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 打开输入文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;input.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> input_file:<br>    <span class="hljs-comment"># 读取文件内容并按行分割</span><br>    ip_addresses = input_file.read().splitlines()<br><br><span class="hljs-comment"># 打开输出文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> output_file:<br>    <span class="hljs-comment"># 遍历每个 IP 地址</span><br>    <span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> ip_addresses:<br>        <span class="hljs-comment"># 添加 http:// 前缀</span><br>        http_ip = <span class="hljs-string">&quot;http://&quot;</span> + ip<br>        <span class="hljs-comment"># 添加 https:// 前缀</span><br>        https_ip = <span class="hljs-string">&quot;https://&quot;</span> + ip<br>        <span class="hljs-comment"># 将结果写入输出文件</span><br>        output_file.write(http_ip + <span class="hljs-string">&quot;\n&quot;</span>)<br>        output_file.write(https_ip + <span class="hljs-string">&quot;\n&quot;</span>)<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python ipadd.py<br></code></pre></td></tr></table></figure>

<p>然后再次对url.txt进行去重，就得到了<strong>web.txt–经过了多次整理得到的最终的web总资产</strong></p>
<p>然后，下一步是什么呢？这些大量web资产不一定都可访问，不一定都是存活的，于是我们需要进行存活探测，于是使用一款指纹识别的工具，在指纹识别的同时也就做了存活探测了，而且指纹的识别也对我们快速打点发现漏洞切入点有极大的帮助，识别出指纹，我们就能从大量杂乱无章的资产中，优先地看一些历史漏洞比较多的CMS，或者OA系统的资产，这样就有可能快速发现Nday，一把梭了~</p>
<p>使用TideFInger或者Ehole做指纹识别</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">TideFinger -uf web.txt -nobr -nopoc <br>TideFinger -uf web.txt<br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/kfASbiWuvJPxrEF.png" srcset="/img/loading.gif" lazyload alt="image-20241212103257146"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ehole.exe finger -l web.txt <br></code></pre></td></tr></table></figure>

<p><img src="https://s2.loli.net/2024/12/12/F2ROCZJQqbtgVwI.png" srcset="/img/loading.gif" lazyload alt="image-20241204193249376"></p>
<h3 id="工具-6"><a href="#工具-6" class="headerlink" title="工具"></a>工具</h3><ul>
<li>TideFinger：<a target="_blank" rel="noopener" href="https://github.com/TideSec/TideFinger_Go">https://github.com/TideSec/TideFinger_Go</a></li>
<li>Ehole：<a target="_blank" rel="noopener" href="https://github.com/EdgeSecurityTeam/EHole">https://github.com/EdgeSecurityTeam/EHole</a></li>
</ul>
<blockquote>
<p>[4]自动化扫描阶段：在开始对具体目标开展更详细更有针对性的信息收集前，可以先批量跑一下漏洞扫描器，虽然对一些经常被人测试的SRC目标来说，漏洞几乎无法发现漏洞了，但是不代表漏扫就没用。比如攻防演练时，漏扫还是很重要的，没有扫出nday的目标，就比较难以打穿了，只能要么0day，要么钓鱼了</p>
</blockquote>
<h2 id="自动化扫描"><a href="#自动化扫描" class="headerlink" title="自动化扫描"></a>自动化扫描</h2><p>也没啥好说的，就是用工具就行，这里还是推荐几个最常用的漏洞扫描器</p>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei">Nuclei</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">nuclei.exe -<span class="hljs-built_in">list</span> test.txt -o output.txt<br></code></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://github.com/zan8in/afrog">Afrog</a></strong></p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs excel">afrog -<span class="hljs-built_in">T</span> urls.txt<br></code></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://www.acunetix.com/">AWVS</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#批量添加目标</span><br>python awvs.py <br></code></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://github.com/XTLS/Xray-core/releases">Xray</a></strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#批量添加目标</span><br>python xray.py -r test.txt<br><br><span class="hljs-comment"># 爬取单个目标</span><br>xray.exe webscan --basic-crawler http://xxxx.com/ --html-output  output-a.html<br><br><span class="hljs-comment"># 监听7777端口，与Brup联动</span><br>xray.exe webscan --listen <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">7777</span> --html-output output-b.html<br></code></pre></td></tr></table></figure>

<p><strong>Goby</strong></p>
<p><img src="https://s2.loli.net/2024/12/12/QJezyWLbY6whMO4.png" srcset="/img/loading.gif" lazyload alt="image-20241212160616003"></p>
<blockquote>
<p>[5]重点目标针对收集阶段：经过了前面的资产发现与扩展整理阶段，我们已经梳理出了一些重点资产，比如是经典框架系统，CMS，OA系统，有登录框，可注册，SSO系统等等……于是接下来就是对这些重点目标进行针对性的深度信息收集了。为什么把架构搜集放在最前面呢，因为假设目标使用了CDN，反向代理，负载均衡，那我们在没搞清楚架构的情况下，就去渗透测试，端口扫描，内网渗透，那将是毫无意义的或者收效甚微的</p>
</blockquote>
<h2 id="架构信息"><a href="#架构信息" class="headerlink" title="架构信息"></a>架构信息</h2><h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>反向代理是指代理服务器接收客户端请求，并将请求转发到一个或多个后端服务器上。通过使用反向代理，可以实现负载均衡、安全增强、SSL终止、缓存等功能。例如，当多个后端服务器承载高并发请求时，反向代理可以智能地分发请求，以减少单个服务器的负担，从而提升系统的性能和可用性。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>使用 <a target="_blank" rel="noopener" href="https://www.wappalyzer.com/">Wappalyzer</a> 浏览器插件可以帮助识别网站是否使用了反向代理。Wappalyzer会分析网站的架构信息，并显示使用的技术栈、服务器以及潜在的代理信息。</p>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>为了防止访问拥塞，减少主服务器的负担，多个负载均衡服务器监听公共网络接口，接收来自客户端的请求，然后将这些请求转发到内网的多个后端服务器端口。负载均衡不仅可以提高访问速度，还能增强系统的容错能力，避免某一个服务器的故障影响整个网站的可用性。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以使用 <strong>lbd</strong> 工具（Kali Linux自带）来识别负载均衡服务器。该工具通过分析目标服务器的响应特征，帮助判断是否存在负载均衡机制。</p>
<h3 id="站库分离"><a href="#站库分离" class="headerlink" title="站库分离"></a>站库分离</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>站库分离是一种将网站前端和数据库后端分离的架构设计。这样，即使攻击者成功入侵了网站服务器，仍然无法直接访问数据库中的敏感数据，因为数据库服务器是独立的。这种分离不仅增强了安全性，还使得网站的维护和扩展变得更加灵活。</p>
<h3 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>为了提升访问体验，在多个地点部署CDN（内容分发网络）服务器，可以自动将用户的请求路由到离其最近的服务器节点，从而就近为用户提供服务。CDN可以有效地提高网站的加载速度和访问稳定性，尤其适用于全球范围内的用户。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以通过 <strong>多地ping</strong> 工具（<a target="_blank" rel="noopener" href="https://www.17ce.com/">17ce</a>）测试不同地理位置的延迟来识别是否使用了CDN。若目标网站使用CDN，通常在不同区域的访问速度和延迟差异较大。</p>
<p><strong>绕过方法</strong>:</p>
<ul>
<li>使用 <strong>全球ping</strong>（<a target="_blank" rel="noopener" href="https://tools.ipip.net/ping.php">ipip.net</a>）</li>
<li>从子域名入手</li>
<li>查找历史DNS解析记录（<a target="_blank" rel="noopener" href="https://site.ip138.com/">IP138</a>）</li>
<li>使用接口查询（<a target="_blank" rel="noopener" href="https://get-site-ip.com/">Get-site-ip</a>）</li>
<li>使用反向邮件</li>
<li><strong>FuckCDN</strong> 工具（<a target="_blank" rel="noopener" href="https://github.com/Tai7sy/fuckcdn">GitHub</a>）</li>
<li>使用 <strong>fofa</strong> 搜索引擎</li>
<li>利用 <strong>SSRF</strong> 漏洞</li>
<li>使用 <strong>phpinfo.php</strong> 探针</li>
</ul>
<h3 id="WAF（Web-Application-Firewall）"><a href="#WAF（Web-Application-Firewall）" class="headerlink" title="WAF（Web Application Firewall）"></a>WAF（Web Application Firewall）</h3><ul>
<li><strong>介绍</strong></li>
</ul>
<p>WAF是专门用于防御HTTP请求中的恶意流量的安全防护工具。通过使用WAF，网站能够有效抵御SQL注入、跨站脚本攻击（XSS）等常见Web攻击。</p>
<ul>
<li><strong>识别</strong></li>
</ul>
<p>可以使用 <a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">wafw00f</a> 工具来识别目标网站是否使用了WAF。此外，结合视觉分析（<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/PWkqNsygi-c_S7tW1y_Hxw">看图识别</a>）也能帮助识别是否存在WAF。</p>
<blockquote>
<p>经<strong>架构信息打点</strong>后，可能会遇到绕过挑战，例如绕过CDN、WAF和反向代理等保护机制。在这时，进一步的源码信息收集变得尤为重要。若网站使用CMS，或源码泄露，渗透测试就可以直接上升为白盒测试，或者直接利用现成的漏洞进行攻击，省去了大部分的打点步骤。</p>
</blockquote>
<h2 id="源码信息"><a href="#源码信息" class="headerlink" title="源码信息"></a>源码信息</h2><h3 id="CMS（内容管理系统）"><a href="#CMS（内容管理系统）" class="headerlink" title="CMS（内容管理系统）"></a>CMS（内容管理系统）</h3><ul>
<li>可以使用工具如 <strong>云悉</strong> (<a target="_blank" rel="noopener" href="https://www.yunsee.cn/">yunsee</a>) 和 <strong>360观星</strong> (<a target="_blank" rel="noopener" href="https://fp.shuziguanxing.com/#/">360观星</a>) 来识别目标网站是否使用了特定的CMS系统。通过识别CMS类型，可以帮助渗透测试人员找到已知的漏洞和攻击路径。</li>
</ul>
<h3 id="闭源售卖"><a href="#闭源售卖" class="headerlink" title="闭源售卖"></a>闭源售卖</h3><ul>
<li>还可以通过一些渠道（如黑源码网站、Google 搜索和正规源码网站）来寻找潜在的源码泄露，尤其是在闭源项目中，源码泄露能为攻击者提供直接的攻击方式。</li>
</ul>
<h3 id="泄露"><a href="#泄露" class="headerlink" title="泄露"></a>泄露</h3><ul>
<li><strong>index of 目录遍历漏洞</strong></li>
<li><strong>githack</strong> (<a target="_blank" rel="noopener" href="https://github.com/lijiejie/GitHack">GitHack</a>)</li>
<li><strong>svnhack</strong> (<a target="_blank" rel="noopener" href="https://github.com/callmefeifei/SvnHack">SvnHack</a>)</li>
<li><strong>ds_store</strong> (<a target="_blank" rel="noopener" href="https://github.com/lijiejie/ds_store_exp">ds_store_exp</a>)</li>
<li><strong>GitHub泄露</strong></li>
<li><strong>网盘泄露</strong></li>
</ul>
<blockquote>
<p>经<strong>源码信息打点</strong>后，若未能收获有价值的信息，接下来只能进行黑盒测试，进一步搜集网站的基本信息。</p>
</blockquote>
<h2 id="网站基本信息"><a href="#网站基本信息" class="headerlink" title="网站基本信息"></a>网站基本信息</h2><h3 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h3><ul>
<li>可以使用 <strong>Wappalyzer</strong> 工具分析网站所使用的编程语言。</li>
</ul>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ul>
<li>使用 <strong>Wappalyzer</strong> 或 <strong>fofa</strong> 进行数据库类型的识别。</li>
</ul>
<h3 id="web容器"><a href="#web容器" class="headerlink" title="web容器"></a>web容器</h3><ul>
<li>同样，<strong>Wappalyzer</strong> 和 <strong>fofa</strong> 可以帮助识别网站使用的Web容器（如Apache、Nginx等）。</li>
</ul>
<h3 id="操作系统"><a href="#操作系统" class="headerlink" title="操作系统"></a>操作系统</h3><ul>
<li>可以通过对目标服务器进行大小写测试和Ping TTL值分析，间接推测目标服务器使用的操作系统。</li>
</ul>
<blockquote>
<p>经<strong>网站基本信息打点</strong>后，已经掌握了大部分网站的构成信息。接下来可以进入更深层次的信息挖掘。</p>
</blockquote>
<h2 id="网站深度信息"><a href="#网站深度信息" class="headerlink" title="网站深度信息"></a>网站深度信息</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><strong>fuff</strong> (<a target="_blank" rel="noopener" href="https://github.com/ffuf/ffuf">GitHub</a>)</li>
<li><strong>7kbscan</strong> (<a target="_blank" rel="noopener" href="https://github.com/7kbstorm/7kbscan-WebPathBrute">7kbscan-WebPathBrute</a>)</li>
<li><strong>dirsearch</strong>（Kali自带）</li>
</ul>
<p>强烈推荐 FUFF 简直是FUZZ神器！</p>
<h3 id="JS接口"><a href="#JS接口" class="headerlink" title="JS接口"></a>JS接口</h3><p>进入API测试</p>
<p>本地浏览器控制台一键下载网站js文件的脚本</p>
<h5 id="downloadjs-py"><a href="#downloadjs-py" class="headerlink" title="downloadjs.py"></a>downloadjs.py</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// Function to download a file</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">downloadFile</span>(<span class="hljs-params">filename, content</span>) &#123;<br>    <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([content], &#123; <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;application/javascript&#x27;</span> &#125;);<br>    <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;a&#x27;</span>);<br>    link.<span class="hljs-property">href</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob);<br>    link.<span class="hljs-property">download</span> = filename;<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(link);<br>    link.<span class="hljs-title function_">click</span>();<br>    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>(link);<br>&#125;<br><br><span class="hljs-comment">// Function to fetch external JS file and download it</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchAndDownload</span>(<span class="hljs-params">url, defaultFilename</span>) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url);<br>        <span class="hljs-keyword">const</span> content = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>();<br>        <span class="hljs-keyword">const</span> filename = url.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">pop</span>() || defaultFilename;<br>        <span class="hljs-title function_">downloadFile</span>(filename, content);<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Downloaded external JS file: <span class="hljs-subst">$&#123;filename&#125;</span>`</span>);<br>    &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to download <span class="hljs-subst">$&#123;url&#125;</span>: <span class="hljs-subst">$&#123;error&#125;</span>`</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Function to download all JavaScript code found in the document</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">downloadAllJS</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// Collect all &lt;script&gt; elements in the document</span><br>    <span class="hljs-keyword">const</span> scripts = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">&#x27;script&#x27;</span>));<br>    <span class="hljs-keyword">let</span> inlineCounter = <span class="hljs-number">1</span>;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> script <span class="hljs-keyword">of</span> scripts) &#123;<br>        <span class="hljs-keyword">if</span> (script.<span class="hljs-property">src</span>) &#123;<br>            <span class="hljs-comment">// Case 2: External JS file</span><br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchAndDownload</span>(script.<span class="hljs-property">src</span>, <span class="hljs-string">`external-script-<span class="hljs-subst">$&#123;inlineCounter&#125;</span>.js`</span>);<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (script.<span class="hljs-property">textContent</span>) &#123;<br>            <span class="hljs-comment">// Case 1 &amp; 3: Inline JS code (could include Webpack bundled code)</span><br>            <span class="hljs-keyword">const</span> filename = <span class="hljs-string">`inline-script-<span class="hljs-subst">$&#123;inlineCounter&#125;</span>.js`</span>;<br>            <span class="hljs-title function_">downloadFile</span>(filename, script.<span class="hljs-property">textContent</span>);<br>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Downloaded inline JS as: <span class="hljs-subst">$&#123;filename&#125;</span>`</span>);<br>            inlineCounter++;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Run the function to download all JS files</span><br><span class="hljs-title function_">downloadAllJS</span>();<br><br></code></pre></td></tr></table></figure>

<p>提取js接口的脚本</p>
<h5 id="findapi-py"><a href="#findapi-py" class="headerlink" title="findapi.py"></a>findapi.py</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> json<br><span class="hljs-keyword">import</span> re<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><br>headers = &#123;<br>    <span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36&quot;</span>&#125;<br><br>fileurl = sys.argv[<span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># 根据传入的文件名确定目录名</span><br>filemkdir = fileurl.split(<span class="hljs-string">&#x27;_&#x27;</span>)[<span class="hljs-number">0</span>]<br><br><span class="hljs-comment"># 确保目录存在</span><br><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(filemkdir):<br>    os.makedirs(filemkdir)<br><br><span class="hljs-comment"># 获取路径</span><br>paths = []<br><span class="hljs-keyword">for</span> dirpath, dirnames, filenames <span class="hljs-keyword">in</span> os.walk(filemkdir):<br>    <span class="hljs-keyword">for</span> file <span class="hljs-keyword">in</span> filenames:<br>        file_path = os.path.join(dirpath, file)<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&#x27;gb18030&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) <span class="hljs-keyword">as</span> f2:<br>                <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f2:<br>                    line = line.strip(<span class="hljs-string">&#x27;\n&#x27;</span>).strip(<span class="hljs-string">&#x27;\t&#x27;</span>)<br>                    p = re.findall(<span class="hljs-string">r&#x27;&#x27;&#x27;([&#x27;&quot;]\/[^][^&gt;&lt; \)\(\&#123;\&#125;]*?[&#x27;&quot;])&#x27;&#x27;&#x27;</span>, line)<br>                    <span class="hljs-keyword">if</span> p:<br>                        <span class="hljs-keyword">for</span> path <span class="hljs-keyword">in</span> p:<br>                            path = path.replace(<span class="hljs-string">&#x27;:&quot;&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&quot;&quot;</span>)<br>                            paths.append(file + <span class="hljs-string">&quot;---&quot;</span> + path)<br>        <span class="hljs-keyword">except</span> FileNotFoundError:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;File not found: <span class="hljs-subst">&#123;file_path&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Error reading file <span class="hljs-subst">&#123;file_path&#125;</span>: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 写入提取到的路径</span><br>output_file = fileurl + <span class="hljs-string">&#x27;_path.txt&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&quot;a+&quot;</span>, encoding=<span class="hljs-string">&#x27;gb18030&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) <span class="hljs-keyword">as</span> output:<br>    <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> <span class="hljs-built_in">sorted</span>(<span class="hljs-built_in">set</span>(paths)):<br>        output.write(var + <span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure>

<ul>
<li><strong>JSfinder</strong></li>
<li><strong>packer-fuzzer</strong></li>
<li><strong>URLfinder</strong></li>
</ul>
<h3 id="快照"><a href="#快照" class="headerlink" title="快照"></a>快照</h3><ul>
<li><strong>网站时光机</strong> (<a target="_blank" rel="noopener" href="https://web.archive.org/">Wayback Machine</a>)</li>
</ul>
<h3 id="插件信息"><a href="#插件信息" class="headerlink" title="插件信息"></a>插件信息</h3><ul>
<li><strong>Wappalyzer</strong> 可以帮助识别网站中所用的插件信息。</li>
</ul>
<h3 id="第三方接口信息"><a href="#第三方接口信息" class="headerlink" title="第三方接口信息"></a>第三方接口信息</h3><ul>
<li><strong>Wappalyzer</strong> 可以识别第三方接口信息，例如支付接口、社交登录等。</li>
</ul>
<h3 id="旁站"><a href="#旁站" class="headerlink" title="旁站"></a>旁站</h3><ul>
<li>使用 <a target="_blank" rel="noopener" href="https://www.webscan.cc/">旁站</a> 工具分析潜在的旁站资源。</li>
</ul>
<h3 id="端口服务"><a href="#端口服务" class="headerlink" title="端口服务"></a>端口服务</h3><ul>
<li><strong>nmap</strong>（Kali自带）可以扫描网站开放的端口，并进一步识别服务信息。</li>
<li><strong>railgun</strong>（推荐，速度快）</li>
</ul>
<table>
<thead>
<tr>
<th><strong>端口号</strong></th>
<th align="center"><strong>服务</strong></th>
<th><strong>攻击方式</strong></th>
<th><strong>常见漏洞</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>21</strong></td>
<td align="center">FTP</td>
<td>弱口令爆破、匿名登录、目录遍历</td>
<td>未授权访问、FTP暴露敏感文件</td>
</tr>
<tr>
<td><strong>22</strong></td>
<td align="center">SSH</td>
<td>弱口令攻击、公私钥猜测、利用旧版本漏洞</td>
<td>CVE-2018-15473 (用户名枚举漏洞)</td>
</tr>
<tr>
<td><strong>23</strong></td>
<td align="center">Telnet</td>
<td>弱口令爆破、明文通信窃听</td>
<td>未授权访问、会话劫持</td>
</tr>
<tr>
<td><strong>25</strong></td>
<td align="center">SMTP</td>
<td>邮件伪造、开放中继测试</td>
<td>未授权中继、CVE-2015-0235 (GHOST 漏洞)</td>
</tr>
<tr>
<td><strong>53</strong></td>
<td align="center">DNS</td>
<td>DNS 缓存中毒、域传送漏洞</td>
<td>DNS 放大攻击、未授权域传送</td>
</tr>
<tr>
<td><strong>80</strong></td>
<td align="center">HTTP</td>
<td>SQL 注入、XSS、CSRF、路径穿越</td>
<td>Web 应用漏洞，如 SQLi、CVE-2021-12345（假设 Web 服务漏洞）</td>
</tr>
<tr>
<td><strong>110</strong></td>
<td align="center">POP3</td>
<td>弱口令攻击、邮件劫持</td>
<td>未授权访问、明文传输</td>
</tr>
<tr>
<td><strong>143</strong></td>
<td align="center">IMAP</td>
<td>邮件劫持、弱口令攻击</td>
<td>未授权访问</td>
</tr>
<tr>
<td><strong>443</strong></td>
<td align="center">HTTPS</td>
<td>SSL&#x2F;TLS 漏洞利用 (如 Heartbleed)、中间人攻击</td>
<td>Heartbleed (CVE-2014-0160)</td>
</tr>
<tr>
<td><strong>3306</strong></td>
<td align="center">MySQL</td>
<td>弱口令攻击、SQL 注入</td>
<td>未授权访问、CVE-2012-2122 (MySQL 身份验证绕过漏洞)</td>
</tr>
<tr>
<td><strong>3389</strong></td>
<td align="center">RDP</td>
<td>弱口令爆破、会话劫持、远程桌面协议利用</td>
<td>CVE-2019-0708 (BlueKeep)</td>
</tr>
<tr>
<td><strong>6379</strong></td>
<td align="center">Redis</td>
<td>未授权访问、配置文件写入攻击</td>
<td>未授权访问，RCE（写 SSH 公钥）</td>
</tr>
<tr>
<td><strong>8080</strong></td>
<td align="center">HTTP Proxy&#x2F;Tomcat</td>
<td>未授权访问、弱口令爆破、路径穿越</td>
<td>Apache Tomcat CVE-2017-12615 (PUT 文件上传漏洞)</td>
</tr>
<tr>
<td><strong>445</strong></td>
<td align="center">SMB</td>
<td>SMB 漏洞利用 (如 EternalBlue)、弱口令攻击</td>
<td>EternalBlue (CVE-2017-0144)、SMBRelay</td>
</tr>
<tr>
<td><strong>135</strong></td>
<td align="center">RPC&#x2F;DCOM</td>
<td>RPC 漏洞利用</td>
<td>CVE-2003-0352 (MS03-026 RPC 漏洞)</td>
</tr>
<tr>
<td><strong>1433</strong></td>
<td align="center">MSSQL</td>
<td>弱口令攻击、数据库注入</td>
<td>未授权访问，CVE-2019-1068 (SQL Server RCE)</td>
</tr>
<tr>
<td><strong>1521</strong></td>
<td align="center">Oracle DB</td>
<td>弱口令爆破、TNS 协议漏洞利用</td>
<td>CVE-2012-1675 (TNS Listener 泄漏漏洞)</td>
</tr>
<tr>
<td><strong>2049</strong></td>
<td align="center">NFS</td>
<td>未授权访问、敏感数据读取</td>
<td>NFS 配置错误，导致敏感数据暴露</td>
</tr>
<tr>
<td><strong>5060</strong></td>
<td align="center">SIP</td>
<td>SIP 协议劫持、放大攻击</td>
<td>未授权访问，SIP 劫持导致话费损失</td>
</tr>
<tr>
<td><strong>11211</strong></td>
<td align="center">Memcached</td>
<td>Memcached 放大攻击</td>
<td>Memcached 未授权访问导致流量放大攻击</td>
</tr>
</tbody></table>
<blockquote>
<p>经<strong>网站具体信息打点后</strong>，基本上已经掌握了大部分的信息。若幸运的话，可能已经发现了漏洞，或者找到了攻击路径。如果还没有突破，可以考虑社工信息收集，但其成功几率相对较小。</p>
</blockquote>
<h2 id="网盘信息"><a href="#网盘信息" class="headerlink" title="网盘信息"></a>网盘信息</h2><p>有时候网盘信息也有可能泄露敏感信息……</p>
<p>这里我把github也归类为”网盘”</p>
<ul>
<li>Github语法</li>
</ul>
<p>利用Github语法检索敏感信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">in</span>:name <span class="hljs-built_in">test</span>			  <span class="hljs-comment">#仓库标题搜索含有关键字</span><br><span class="hljs-keyword">in</span>:descripton <span class="hljs-built_in">test</span>         <span class="hljs-comment">#仓库描述搜索含有关键字</span><br><span class="hljs-keyword">in</span>:readme <span class="hljs-built_in">test</span>             <span class="hljs-comment">#Readme文件搜素含有关键字</span><br>stars:&gt;3000 <span class="hljs-built_in">test</span>           <span class="hljs-comment">#stars数量大于3000的搜索关键字</span><br>stars:1000..3000 <span class="hljs-built_in">test</span>      <span class="hljs-comment">#stars数量大于1000小于3000的搜索关键字</span><br>forks:&gt;1000 <span class="hljs-built_in">test</span>           <span class="hljs-comment">#forks数量大于1000的搜索关键字</span><br>forks:1000..3000 <span class="hljs-built_in">test</span>      <span class="hljs-comment">#forks数量大于1000小于3000的搜索关键字</span><br>size:&gt;=5000 <span class="hljs-built_in">test</span>           <span class="hljs-comment">#指定仓库大于5000k(5M)的搜索关键字</span><br>pushed:&gt;2019-02-12 <span class="hljs-built_in">test</span>    <span class="hljs-comment">#发布时间大于2019-02-12的搜索关键字</span><br>created:&gt;2019-02-12 <span class="hljs-built_in">test</span>   <span class="hljs-comment">#创建时间大于2019-02-12的搜索关键字</span><br>user:<span class="hljs-built_in">test</span>                  <span class="hljs-comment">#用户名搜素</span><br>license:apache-2.0 <span class="hljs-built_in">test</span>    <span class="hljs-comment">#明确仓库的 LICENSE 搜索关键字</span><br>language:java <span class="hljs-built_in">test</span>         <span class="hljs-comment">#在java语言的代码中搜索关键字</span><br>user:<span class="hljs-built_in">test</span> <span class="hljs-keyword">in</span>:name <span class="hljs-built_in">test</span>     <span class="hljs-comment">#组合搜索,用户名test的标题含有test的</span><br><br>site:Github.com smtp<br>site:Github.com smtp @qq.com<br>site:Github.com smtp @126.com<br>site:Github.com smtp @163.com<br>site:Github.com smtp @sina.com.cn<br>site:Github.com smtp password<br>site:Github.com String password smtp<br>site:Github.com smtp @baidu.com<br><br>site:Github.com sa password<br>site:Github.com root password<br>site:Github.com User ID=’sa’;Password<br>site:Github.com inurl:sql<br><br>site:Github.com svn<br>site:Github.com svn username<br>site:Github.com svn password<br>site:Github.com svn username password<br><br>site:Github.com password<br>site:Github.com ftp ftppassword<br>site:Github.com 密码<br>site:Github.com 内部<br></code></pre></td></tr></table></figure>

<p>Github监控</p>
<ul>
<li>云绘监控：<a target="_blank" rel="noopener" href="https://github.yhuisec.com/">https://github.yhuisec.com/</a></li>
</ul>
<p><img src="https://s2.loli.net/2024/12/07/o9HFcvJO8BbWf36.png" srcset="/img/loading.gif" lazyload alt="img"></p>
<ul>
<li>凌风云</li>
<li>gitlab</li>
<li>码云</li>
<li>语雀</li>
<li>其他网盘</li>
</ul>
<h3 id="工具-7"><a href="#工具-7" class="headerlink" title="工具"></a>工具</h3><ul>
<li>gitdorks_go：<a target="_blank" rel="noopener" href="https://github.com/damit5/gitdorks_go">https://github.com/damit5/gitdorks_go</a></li>
<li>GitDorker：<a target="_blank" rel="noopener" href="https://github.com/obheda12/GitDorker">https://github.com/obheda12/GitDorker</a></li>
</ul>
<h2 id="社工信息"><a href="#社工信息" class="headerlink" title="社工信息"></a>社工信息</h2><p>社工信息收集主要依赖人工去查找，目标是找出与目标相关的域名服务商、服务器供应商、网站管理员和开发人员等信息。</p>
<p>善用：</p>
<ul>
<li>goole语法</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable constant_">PHP</span>后缀参数<br><br><span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span> <span class="hljs-attr">ext</span>:php <span class="hljs-attr">inurl</span>:?<br>openbugbounty关于该域名的报告<br><br><span class="hljs-attr">site</span>:openbugbounty.<span class="hljs-property">org</span> <span class="hljs-attr">inurl</span>:reports <span class="hljs-attr">intext</span>:<span class="hljs-string">&quot;baidu.com&quot;</span><br>敏感信息后缀<br><br><span class="hljs-attr">site</span>:<span class="hljs-string">&quot;baidu.com&quot;</span> <span class="hljs-attr">ext</span>:log | <span class="hljs-attr">ext</span>:txt | <span class="hljs-attr">ext</span>:conf | <span class="hljs-attr">ext</span>:cnf | <span class="hljs-attr">ext</span>:ini | <span class="hljs-attr">ext</span>:env | <span class="hljs-attr">ext</span>:sh | <span class="hljs-attr">ext</span>:bak | <span class="hljs-attr">ext</span>:backup | <span class="hljs-attr">ext</span>:swp | <span class="hljs-attr">ext</span>:old | <span class="hljs-attr">ext</span>:~ | <span class="hljs-attr">ext</span>:git | <span class="hljs-attr">ext</span>:svn | <span class="hljs-attr">ext</span>:htpasswd | <span class="hljs-attr">ext</span>:htaccess<br>易受<span class="hljs-variable constant_">XSS</span>攻击的参数<br><br><span class="hljs-attr">inurl</span>:q= | <span class="hljs-attr">inurl</span>:s= | <span class="hljs-attr">inurl</span>:search= | <span class="hljs-attr">inurl</span>:query= | <span class="hljs-attr">inurl</span>:keyword= | <span class="hljs-attr">inurl</span>:lang= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br>开放重定向参数<br><br><span class="hljs-attr">inurl</span>:url= | <span class="hljs-attr">inurl</span>:<span class="hljs-keyword">return</span>= | <span class="hljs-attr">inurl</span>:next= | <span class="hljs-attr">inurl</span>:redirect= | <span class="hljs-attr">inurl</span>:redir= | <span class="hljs-attr">inurl</span>:ret= | <span class="hljs-attr">inurl</span>:r2= | <span class="hljs-attr">inurl</span>:page= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">inurl</span>:http <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br>sql报错参数<br><br><span class="hljs-attr">inurl</span>:id= | <span class="hljs-attr">inurl</span>:pid= | <span class="hljs-attr">inurl</span>:category= | <span class="hljs-attr">inurl</span>:cat= | <span class="hljs-attr">inurl</span>:action= | <span class="hljs-attr">inurl</span>:sid= | <span class="hljs-attr">inurl</span>:dir= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br><span class="hljs-variable constant_">SSRF</span>易发参数<br><br><span class="hljs-attr">inurl</span>:http | <span class="hljs-attr">inurl</span>:url= | <span class="hljs-attr">inurl</span>:path= | <span class="hljs-attr">inurl</span>:dest= | <span class="hljs-attr">inurl</span>:html= | <span class="hljs-attr">inurl</span>:data= | <span class="hljs-attr">inurl</span>:domain= | <span class="hljs-attr">inurl</span>:page= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br><span class="hljs-variable constant_">LFI</span>常见参数<br><br><span class="hljs-attr">inurl</span>:include | <span class="hljs-attr">inurl</span>:dir | <span class="hljs-attr">inurl</span>:detail= | <span class="hljs-attr">inurl</span>:file= | <span class="hljs-attr">inurl</span>:folder= | <span class="hljs-attr">inurl</span>:inc= | <span class="hljs-attr">inurl</span>:locate= | <span class="hljs-attr">inurl</span>:doc= | <span class="hljs-attr">inurl</span>:conf= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br><span class="hljs-variable constant_">RCE</span>常见参数<br><br><span class="hljs-attr">inurl</span>:cmd | <span class="hljs-attr">inurl</span>:exec= | <span class="hljs-attr">inurl</span>:query= | <span class="hljs-attr">inurl</span>:code= | <span class="hljs-attr">inurl</span>:<span class="hljs-keyword">do</span>= | <span class="hljs-attr">inurl</span>:run= | <span class="hljs-attr">inurl</span>:read= | <span class="hljs-attr">inurl</span>:ping= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br>敏感关键字<br><br><span class="hljs-attr">inurl</span>:config | <span class="hljs-attr">inurl</span>:env | <span class="hljs-attr">inurl</span>:setting | <span class="hljs-attr">inurl</span>:backup | <span class="hljs-attr">inurl</span>:admin | <span class="hljs-attr">inurl</span>:php <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br>敏感参数<br><br><span class="hljs-attr">inurl</span>:email= | <span class="hljs-attr">inurl</span>:phone= | <span class="hljs-attr">inurl</span>:password= | <span class="hljs-attr">inurl</span>:secret= <span class="hljs-attr">inurl</span>:&amp; <span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span><br><span class="hljs-variable constant_">API</span>文档<br><br><span class="hljs-attr">inurl</span>:apidocs | <span class="hljs-attr">inurl</span>:api-docs | <span class="hljs-attr">inurl</span>:swagger | <span class="hljs-attr">inurl</span>:api-explorer <span class="hljs-attr">site</span>:<span class="hljs-string">&quot;baidu.com&quot;</span><br>代码泄露<br><br><span class="hljs-attr">site</span>:pastebin.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:jsfiddle.<span class="hljs-property">net</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:codebeautify.<span class="hljs-property">org</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:codepen.<span class="hljs-property">io</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br>云存储<br><br><span class="hljs-attr">site</span>:s3.<span class="hljs-property">amazonaws</span>.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:blob.<span class="hljs-property">core</span>.<span class="hljs-property">windows</span>.<span class="hljs-property">net</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:googleapis.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:drive.<span class="hljs-property">google</span>.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:dev.<span class="hljs-property">azure</span>.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:onedrive.<span class="hljs-property">live</span>.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:digitaloceanspaces.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:sharepoint.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:s3-external-<span class="hljs-number">1.</span>amazonaws.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:s3.<span class="hljs-property">dualstack</span>.<span class="hljs-property">us</span>-east-<span class="hljs-number">1.</span>amazonaws.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:dropbox.<span class="hljs-property">com</span>/s <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:box.<span class="hljs-property">com</span>/s <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-attr">site</span>:docs.<span class="hljs-property">google</span>.<span class="hljs-property">com</span> <span class="hljs-attr">inurl</span>:<span class="hljs-string">&quot;/d/&quot;</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-title class_">JFrog</span> 软件工件管理工具<br><br><span class="hljs-attr">site</span>:jfrog.<span class="hljs-property">io</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br><span class="hljs-title class_">Firebase</span><br><br><span class="hljs-attr">site</span>:firebaseio.<span class="hljs-property">com</span> <span class="hljs-string">&quot;baidu.com&quot;</span><br>文件上传点<br><br><span class="hljs-attr">site</span>:baidu.<span class="hljs-property">com</span> ”choose file”<br>漏洞赏金计划和漏洞披露计划<br><br><span class="hljs-string">&quot;submit vulnerability report&quot;</span> | <span class="hljs-string">&quot;powered by bugcrowd&quot;</span> | <span class="hljs-string">&quot;powered by hackerone&quot;</span><br><span class="hljs-attr">site</span>:*/security.<span class="hljs-property">txt</span> <span class="hljs-string">&quot;bounty&quot;</span><br><span class="hljs-title class_">Apache</span>服务器状态暴露<br><br><span class="hljs-attr">site</span>:*/server-status apache<br><span class="hljs-title class_">WordPress</span><br><br><span class="hljs-attr">inurl</span>:<span class="hljs-regexp">/wp-admin/</span>admin-ajax.<span class="hljs-property">php</span><br><span class="hljs-title class_">Drupal</span><br><br><span class="hljs-attr">intext</span>:<span class="hljs-string">&quot;Powered by&quot;</span> &amp; <span class="hljs-attr">intext</span>:<span class="hljs-title class_">Drupal</span> &amp; <span class="hljs-attr">inurl</span>:user<br><span class="hljs-title class_">Joomla</span><br><br><span class="hljs-attr">site</span>:*<span class="hljs-regexp">/joomla/</span>login<br></code></pre></td></tr></table></figure>

<ul>
<li>百度 </li>
<li>各种社交媒体 </li>
<li>甚至是可联网的搜索的AI</li>
</ul>
<blockquote>
<p>网站资产信息打点到此为止，但我们仍可以对目标旗下的小程序、APP进行进一步的信息搜集。</p>
</blockquote>
<h2 id="小程序信息"><a href="#小程序信息" class="headerlink" title="小程序信息"></a>小程序信息</h2><p>小程序和APP的信息收集方法不多赘述，简单提及如下：</p>
<ul>
<li>使用安卓模拟器或 <strong>Burp Suite</strong> 等抓包工具分析出Web资产，然后重复上述信息收集步骤。</li>
<li>反编译源码，查找泄露信息，提取接口、JS逆向签名、加密算法等信息。</li>
</ul>
<h2 id="APP信息"><a href="#APP信息" class="headerlink" title="APP信息"></a>APP信息</h2><h3 id="外在"><a href="#外在" class="headerlink" title="外在"></a>外在</h3><ul>
<li>使用安卓模拟器和 <strong>Burp Suite</strong> 抓包工具分析Web资产，重复信息收集步骤。</li>
</ul>
<h3 id="内在"><a href="#内在" class="headerlink" title="内在"></a>内在</h3><ul>
<li><strong>查壳工具</strong> 查找壳（<a target="_blank" rel="noopener" href="https://github.com/itsmenaga/apkscan">apkscan</a>）</li>
<li><strong>安卓信息提取器</strong>（<a target="_blank" rel="noopener" href="https://github.com/kelvinBen/AppInfoScanner">AppInfoScanner</a>）</li>
<li><strong>安卓修改大师</strong>（<a target="_blank" rel="noopener" href="https://www.apkeditor.cn/">APKEditor</a>）进行反编译</li>
</ul>
<p>信息收集是灵活的，不必局限于某一固定的思路。关键是学习如何通过一层层剥茧收集目标信息，分析他人收集信息的思维方式，而不仅仅是手段。</p>
<blockquote>
<p>本文略讲了信息收集的冰山一角，侧重点在资产发现与扩展和整理上，重点资产针对性深度收集部分比较简略。但其实信息搜集的艺术远不止此，笔者也技术浅薄，仍需多多学习，如有不对之处还请师傅们斧正！</p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>万字长文窥探信息收集真正的艺术</div>
      <div>https://x1lys.github.io/2024/12/12/万字长文窥探信息收集真正的艺术/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>X1ly?S</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2024年12月12日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/12/07/%E6%B7%B1%E5%BA%A6%E5%88%A9%E7%94%A8Github%E5%AF%BB%E6%89%BE%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF/" title="深度利用Github寻找敏感信息">
                        <span class="hidden-mobile">深度利用Github寻找敏感信息</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
